# ShaderSlang.Net

[![CI](https://github.com/AlexisPollonni/Slang.Net/actions/workflows/continuous.yml/badge.svg)](https://github.com/AlexisPollonni/Slang.Net/actions/workflows/continuous.yml)
[![.NET 10](https://img.shields.io/badge/.NET-10.0-5C2D91)](https://dotnet.microsoft.com/download/dotnet/10.0)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

**ShaderSlang.Net** is a comprehensive .NET 10 library providing bindings for [Slang](https://github.com/shader-slang/slang), a real-time shader programming language. The bindings are auto-generated using [ClangSharp](https://github.com/dotnet/ClangSharp) parsing Slang C/C++ header files.

This is a complete fork and rewrite of the original [SlangNet](https://github.com/Helco/SlangNet) project, using the latest .NET 10 with source generated COM interop.

A NuGet package for the project is provided here: *(Coming soon - currently distributed via GitHub Packages)*

Nightly/pre-release packages are available via GitHub Packages. See [Package Distribution](#package-distribution) for setup instructions.

## Table of Contents

- [Features](#features)
- [Package Structure](#package-structure)
  - [Core Packages](#core-packages)
  - [Native Binary Platform Specific Packages](#native-binary-platform-specific-packages)
- [Installation](#installation)
- [Examples](#examples)
- [Architecture](#architecture)
- [Supported Compilation Targets](#supported-compilation-targets)
- [Requirements](#requirements)
- [Building from Source](#building-from-source)
- [Generating Bindings](#generating-bindings)
- [Package Distribution](#package-distribution)
- [Contributing](#contributing)
- [Code of Conduct](#code-of-conduct)
- [Attribution](#attribution)
- [License](#license)

## Features

- **Complete Slang API Coverage**: Full bindings to the Slang shader compilation and reflection APIs
- **Modern .NET 10**: Built on .NET 10 with latest C# language features
- **Multiple API Layers**: Raw P/Invoke bindings, COM wrappers, and high-level idiomatic APIs
- **Cross-Platform**: Native binaries for Windows (x64, ARM64), Linux (x64, ARM64), and macOS (x64, ARM64)
- **Advanced Interop**: Modern COM interop using .NET's GeneratedComInterface
- **Shader Compilation**: Compile Slang shaders to multiple target formats (HLSL, GLSL, SPIRV, DXBC, DXIL, Metal, etc.)
- **Reflection Support**: Full shader reflection capabilities for parameter binding and layout information
- **Graphics Integration**: Graphics API abstractions with device and command buffer support

## Package Structure

ShaderSlang.Net is distributed as multiple NuGet packages to provide flexibility:

### Core Packages

| Package | Version | Description | Use Case |
|---------|---------|-------------|----------|
| **`ShaderSlang.Net`** | ![Version](https://img.shields.io/github/v/release/AlexisPollonni/Slang.Net?filter=ShaderSlang.Net-*&label=&color=004880) | Complete meta-package including all components | Most users - single dependency |
| **`ShaderSlang.Net.Bindings`** | ![Version](https://img.shields.io/github/v/release/AlexisPollonni/Slang.Net?filter=ShaderSlang.Net.Bindings-*&label=&color=004880) | Raw P/Invoke bindings generated by ClangSharp | Direct C API access |
| **`ShaderSlang.Net.ComWrappers`** | ![Version](https://img.shields.io/github/v/release/AlexisPollonni/Slang.Net?filter=ShaderSlang.Net.ComWrappers-*&label=&color=004880) | Modern COM interface wrappers using GeneratedComInterface | Type-safe COM interop |
| **`ShaderSlang.Net.Pretty`** | ![Version](https://img.shields.io/github/v/release/AlexisPollonni/Slang.Net?filter=ShaderSlang.Net.Pretty-*&label=&color=004880) | High-level idiomatic C# API wrapper | Recommended for most development |

### Native Binary Platform Specific Packages

| Package | Version | Platform | Architecture |
|---------|---------|----------|--------------|
| **`ShaderSlang.Net.Native.Runtime.win-x64`** | ![Version](https://img.shields.io/github/v/release/AlexisPollonni/Slang.Net?filter=ShaderSlang.Net.Native.Runtime.win-x64-*&label=&color=0078d4) | Windows | x64 |
| **`ShaderSlang.Net.Native.Runtime.win-arm64`** | ![Version](https://img.shields.io/github/v/release/AlexisPollonni/Slang.Net?filter=ShaderSlang.Net.Native.Runtime.win-arm64-*&label=&color=0078d4) | Windows | ARM64 |
| **`ShaderSlang.Net.Native.Runtime.linux-x64`** | ![Version](https://img.shields.io/github/v/release/AlexisPollonni/Slang.Net?filter=ShaderSlang.Net.Native.Runtime.linux-x64-*&label=&color=FCC624) | Linux | x64 |
| **`ShaderSlang.Net.Native.Runtime.linux-arm64`** | ![Version](https://img.shields.io/github/v/release/AlexisPollonni/Slang.Net?filter=ShaderSlang.Net.Native.Runtime.linux-arm64-*&label=&color=FCC624) | Linux | ARM64 |
| **`ShaderSlang.Net.Native.Runtime.osx-x64`** | ![Version](https://img.shields.io/github/v/release/AlexisPollonni/Slang.Net?filter=ShaderSlang.Net.Native.Runtime.osx-x64-*&label=&color=000000) | macOS | x64 |
| **`ShaderSlang.Net.Native.Runtime.osx-arm64`** | ![Version](https://img.shields.io/github/v/release/AlexisPollonni/Slang.Net?filter=ShaderSlang.Net.Native.Runtime.osx-arm64-*&label=&color=000000) | macOS | ARM64 |

*Native packages are automatically resolved when using the main packages.*

## Installation

### Quick Start (Recommended)
```xml
<PackageReference Include="ShaderSlang.Net" Version="*" />
```

### Granular Control
```xml
<!-- For raw P/Invoke bindings -->
<PackageReference Include="ShaderSlang.Net.Bindings" Version="*" />

<!-- For COM interface wrappers -->
<PackageReference Include="ShaderSlang.Net.ComWrappers" Version="*" />

<!-- For high-level idiomatic API -->
<PackageReference Include="ShaderSlang.Net.Pretty" Version="*" />
```

## Examples

For comprehensive examples and real-world usage of the bindings, see the **[ShaderSlang.Net.Tests](./ShaderSlang.Net.Tests/)** project. The test suite demonstrates:

- **[Examples/](./ShaderSlang.Net.Tests/Examples/)** - Practical usage scenarios including:
  - Basic shader compilation
  - Multi-target compilation (HLSL, SPIR-V, GLSL, etc.)
  - Shader reflection and parameter enumeration
  - Graphics API integration
- **[Common/](./ShaderSlang.Net.Tests/Common/)** - Shared test utilities and helper methods
- **[Generated/](./ShaderSlang.Net.Tests/Generated/)** - Automated validation tests for struct sizes and layouts


## Architecture

### Layer 1: Raw Bindings (`ShaderSlang.Net.Bindings`)
- Direct P/Invoke declarations generated from Slang C headers
- Unsafe pointers and manual memory management
- Complete API coverage with no abstraction

### Layer 2: COM Wrappers (`ShaderSlang.Net.ComWrappers`)  
- Modern .NET GeneratedComInterface-based COM interop
- Type-safe interface definitions
- Automatic lifetime management
- Custom marshallers for Slang-specific types

### Layer 3: Pretty API (`ShaderSlang.Net.Pretty`)
- High-level, idiomatic C# API
- IDisposable implementations mirroring RAII patterns
- Extension methods and helper utilities
- Graphics API abstractions

## Supported Compilation Targets

ShaderSlang.Net supports compilation to all Slang target formats:

- **HLSL** - DirectX High-Level Shading Language
- **GLSL** - OpenGL Shading Language  
- **SPIRV** - Vulkan SPIR-V bytecode
- **DXBC/DXIL** - DirectX bytecode formats
- **Metal** - Apple Metal shading language
- **CUDA** - NVIDIA CUDA C++
- **C/C++ Source** - Host-callable code generation

And more, see slang repository for complete list. As well as other up to date capabilities.

## Requirements

- **.NET 10.0 RC or later** - [Download .NET 10](https://dotnet.microsoft.com/download/dotnet/10.0)
- **Supported Platforms**: Windows, Linux, macOS
- **Architectures**: x64, ARM64

## Building from Source

ShaderSlang.Net requires the [.NET 10 SDK](https://dotnet.microsoft.com/download/dotnet/10.0) and can be built simply with:

```bash
dotnet build -c Release
```

### Running Tests

```bash
dotnet test -c Release
```

### Creating Packages

```bash
dotnet pack -c Release
```

## Generating Bindings

The bindings are auto-generated using [ClangSharp](https://github.com/dotnet/ClangSharp) by parsing Slang C/C++ header files. The generation is handled by Cake scripts in the `Scripts/` directory.

### Prerequisites

- Clone or download the [Slang repository](https://github.com/shader-slang/slang)
- Ensure you have the .NET 10 SDK installed

### Generation Command

To regenerate bindings, run the generation script:

```bash
# Generate bindings
dotnet run Scripts/GenerateSlang.cs
```

The generation process:
1. Parses Slang C/C++ headers using libclang
2. Generates P/Invoke bindings in `ShaderSlang.Net.Bindings`
3. Extracts XML documentation from header comments
4. Creates simple validation tests to ensure correct struct sizes and layouts

## Attribution

This project is a complete fork and rewrite of the original [SlangNet](https://github.com/Helco/SlangNet) by Helco. While the core concept and some structural ideas are derived from the original work, this implementation has been rebuilt from the ground up to use the new interop source generators and adds custom build scripts to facilitate bindings generation.

As the original project was abandoned, I will take on keeping bindings up to date as much as possible. **Contributions are welcome!**

**Original Slang Library**: [shader-slang/slang](https://github.com/shader-slang/slang)

## Contributing

Contributions are welcome! Please feel free to submit issues or pull requests.

When contributing, please:
- Follow the existing code style
- Ensure all tests pass before submitting a PR
- Format your code with CSharpier

## Package Distribution

Packages are distributed via **GitHub Packages**. To use these packages, configure your NuGet sources:

### Option 1: Add to NuGet.config

Create or update `NuGet.config` in your solution root or user config:

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <packageSources>
    <add key="github-slangnet" value="https://nuget.pkg.github.com/AlexisPollonni/index.json" />
  </packageSources>
  <packageSourceCredentials>
    <github-slangnet>
      <add key="Username" value="YOUR_GITHUB_USERNAME" />
      <add key="ClearTextPassword" value="YOUR_GITHUB_PAT" />
    </github-slangnet>
  </packageSourceCredentials>
</configuration>
```

### Option 2: Using dotnet CLI

```bash
dotnet nuget add source https://nuget.pkg.github.com/AlexisPollonni/index.json \
  --name github-slangnet \
  --username YOUR_GITHUB_USERNAME \
  --password YOUR_GITHUB_PAT \
  --store-password-in-clear-text
```

**Note**: You need a GitHub Personal Access Token (PAT). Create one at: [GitHub Settings → Developer Settings → Personal Access Tokens](https://github.com/settings/tokens)

**NuGet.org upload will come later**, when the API is more stable.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.